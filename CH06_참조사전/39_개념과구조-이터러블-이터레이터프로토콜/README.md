## 이터러블과 이터러블프로토콜

[이터레이션 프로토콜 (Iteration protocols)](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Iteration_protocols)

※ Iteration - 반복 <br />
※ Iterable - 반복 가능한, 반복자.

<br />

🤔 "반복이 가능한 구조라는 것은 어떤 것일까?"

바로 생각나는건, '배열' 같은 구조가 있다.<br />
자바스크립트에서는 이 '배열'말고 반복 가능한 구조가 굉장히 많이 생기고 있다.(map, set, 배열, 객체, 제너레이터, ...)<br />
이 모든게 `이터레이션 프로토콜`에 의해서 작동되는 매커니즘이다.<br />
그래서 이에 대한 기본적인 개념을 알고 있는 것은 중요하다... :)

---

```
1. 이터레이션 프로토콜
2. 사용자 이터러블 객체
```

<br />

### The iterable protocol - MDN

"iterable protocol 은 자바스크립트 객체들이, <br />
예를 들어 for..of 구조에서 어떠한 value 들이 loop 되는 것과 같은 iteration 동작을<br />
정의하거나 사용자 정의하는 것을 허용합니다. (...)"

🤔? "무슨 말이지...?"

기본적으로 이터레이터 프로토콜이라고 하는 것은 반환 값 객체에 `next()`라고 하는 메소드가 있어야 하고, ([해당내용](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Iteration_protocols#the_iterator_protocol))<br />
이 함수가 반환하는 개체는 `done`이라고 하는 `boolean 속성`과 `value라고 하는 속성`이 있어야 한다.<br />
(...이건 마치 제너레이터 함수가 반환하는 제너레이터 안에 있는 next와 done, value와 똑같은 상황...?! 그 이유는 제너레이터 함수가 이터레이션 프로토콜을 구현한 구현체이기 때문...)

🤔? "그래서 이게 왜 중요하죠?..."

<br />

```js
const myIterable = {};

/**
 * Symbol - 언어 구조에서 유일한 값을 만들어내는 기능.
 * 아래와 같이 특별한 key를 만들 때 문자열로 만들면 똑같은 문자열로 다른 내용을 만들어 낼 수도 있는데, 
 * 이런 것들을 제한하기 위해서 unique한 value를 만들어내는 용도의 기본 값이다. 
 * 그중에 'iterator'는 시스템에서 정의하고 있는 값들 가운데 하나다.
 */
// - myIterable 객체에 Symbol.iterator key를 주고 이터레이션 프로토콜을 준수하는 함수를 넣어줬다.
myIterable[Symbol.iterator] = function* () {
  let i = 1;
  while (i <= 100) {
    yield i++;
  }
};

// .next()를 호출하지 않았음에도 불구하고 1부터 100까지 출력한다.
for (const n of myIterable) {
  console.log(n);
}
```

"`for of`에는 `.next()`함수를 호출하는 코드가 없는데, 어떻게 이렇게 제너레이터 함수 안에 `yield`를 계속 재개시킬 수 있었을까?"

이유는, `for of`가 이터레이터 프로토콜을 준수하는 문이기 때문에 그렇다.<br />
숨겨져 있는 것... 값을 꺼내 올 때, next를 꺼내 오고<br />
그 next 안에 value라고 하는 값을 참조해서 값을 n에다가 넣는 것.<br />
그리고 done이 true인지 false인지를 따라서 `for of`의 반복을 결정하고, ...<br />
이런 것들이 이터레이션 프로토콜을 준수함으로써 훨씬 문 자체가 깔끔해지고,<br />
불필요한 구성 요소가 없는 상태로 만들어지는 것이다.

이 프로토콜을 준수하면 이런 간단한 제너레이터 말고도 굉장히 재미있는(!😅) 반복되는 자료 구조들을 만들어낼 수 있다. <br />
어떤 자료 구조를 만들 수 있는가라고 하는 건 어떤 애플리케이션, 혹은 어떤 문제를 푸는가에 따라서 달라질 테니까, <br />
다양한 코드 패턴들을 학습할 필요가 있고, 연구해 볼 가치가 있는 듯 하다.

그래서 나만의 혹은 커스텀 반복자를 만드는데 굉장히 중요한 프로토콜이고 자바스크립트가 제공하는 자료 구조 중에서도 이렇게 반복되는 자료 구조들이 많기 때문에 기본적이지만 아주 중요한 이 프로토콜에 대한 이해를 충분히 하고 있으면 좋다. :)
